<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shipment Data Submission</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        form {
            margin-bottom: 20px;
            display: none; /* Initially hidden */
        }
        input, select, button {
            padding: 10px;
            margin: 5px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 10px;
            text-align: left;
            border: 1px solid #ddd;
        }
        #addButton {
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        #downloadButton {
            padding: 10px;
            background-color: #008CBA;
            color: white;
            border: none;
            cursor: pointer;
        }
        #searchInput {
            margin-top: 10px;
            padding: 10px;
        }
    </style>
</head>
<body>
    <h1>Shipment Data Submission</h1>

    <!-- Add Data Button -->
    <button id="addButton">Add Data</button>

    <!-- Search Option -->
    <input type="text" id="searchInput" placeholder="Search by Buyer or Style" oninput="searchData()">

    <form id="shipmentForm">
        <label for="buyer">Buyer:</label>
        <input type="text" id="buyer" name="buyer" required><br><br>

        <label for="style">Style/Article:</label>
        <input type="text" id="style" name="style" required><br><br>

        <label for="orderNo">PO/Order No:</label>
        <input type="text" id="orderNo" name="orderNo" required><br><br>

        <label for="country">Country:</label>
        <input type="text" id="country" name="country" required><br><br>

        <label for="color">Color:</label>
        <input type="text" id="color" name="color" required><br><br>

        <label for="orderQty">Order Quantity:</label>
        <input type="number" id="orderQty" name="orderQty" required><br><br>

        <label for="shipDate">Ship Date:</label>
        <input type="date" id="shipDate" name="shipDate" required><br><br>

        <button type="submit">Submit</button>
    </form>

    <!-- Download Data Button -->
    <button id="downloadButton" onclick="downloadCSV()">Download Data</button>

    <h2>Submitted Data</h2>
    <table id="dataTable">
        <thead>
            <tr>
                <th>Buyer</th>
                <th>Style/Article</th>
                <th>PO/Order No</th>
                <th>Country</th>
                <th>Color</th>
                <th>Order Quantity</th>
                <th>Ship Date</th>
            </tr>
        </thead>
        <tbody>
            <!-- Submitted data will be displayed here -->
        </tbody>
    </table>

    <script>
        // Load data from localStorage on page load
        document.addEventListener('DOMContentLoaded', loadData);

        // Handle form submission
        document.getElementById('shipmentForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent the form from refreshing the page

            // Get form values
            const buyer = document.getElementById('buyer').value;
            const style = document.getElementById('style').value;
            const orderNo = document.getElementById('orderNo').value;
            const country = document.getElementById('country').value;
            const color = document.getElementById('color').value;
            const orderQty = document.getElementById('orderQty').value;
            const shipDate = document.getElementById('shipDate').value;

            // Create an object to store the data
            const shipmentData = {
                buyer: buyer,
                style: style,
                orderNo: orderNo,
                country: country,
                color: color,
                orderQty: orderQty,
                shipDate: shipDate
            };

            // Get the existing data from localStorage, or initialize it if empty
            let storedData = JSON.parse(localStorage.getItem('shipmentData')) || [];
            
            // Add the new data to the stored data array
            storedData.push(shipmentData);

            // Save the updated data back to localStorage
            localStorage.setItem('shipmentData', JSON.stringify(storedData));

            // Clear the form
            document.getElementById('shipmentForm').reset();

            // Reload the table with the updated data
            loadData();
        });

        // Function to load data from localStorage and display it in a table
        function loadData() {
            const dataTable = document.getElementById('dataTable').getElementsByTagName('tbody')[0];
            dataTable.innerHTML = ''; // Clear the table before reloading data
            const storedData = JSON.parse(localStorage.getItem('shipmentData')) || [];

            // Loop through the stored data and create table rows
            storedData.forEach(function(data) {
                const row = dataTable.insertRow();
                row.insertCell(0).textContent = data.buyer;
                row.insertCell(1).textContent = data.style;
                row.insertCell(2).textContent = data.orderNo;
                row.insertCell(3).textContent = data.country;
                row.insertCell(4).textContent = data.color;
                row.insertCell(5).textContent = data.orderQty;
                row.insertCell(6).textContent = data.shipDate;
            });
        }

        // Toggle form visibility when Add Data button is clicked
        document.getElementById('addButton').addEventListener('click', function() {
            const form = document.getElementById('shipmentForm');
            form.style.display = form.style.display === 'none' ? 'block' : 'none';
        });

        // Function to download the data as a CSV file
        function downloadCSV() {
            const storedData = JSON.parse(localStorage.getItem('shipmentData')) || [];
            let csvContent = "Buyer,Style/Article,PO/Order No,Country,Color,Order Quantity,Ship Date\n";
            
            storedData.forEach(function(data) {
                csvContent += `${data.buyer},${data.style},${data.orderNo},${data.country},${data.color},${data.orderQty},${data.shipDate}\n`;
            });

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement("a");
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute("href", url);
                link.setAttribute("download", "shipment_data.csv");
                link.click();
            }
        }

        // Function to search the data
        function searchData() {
            const searchInput = document.getElementById('searchInput').value.toLowerCase();
            const dataTable = document.getElementById('dataTable').getElementsByTagName('tbody')[0];
            const rows = dataTable.getElementsByTagName('tr');
            
            for (let i = 0; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                let showRow = false;
                for (let j = 0; j < cells.length; j++) {
                    if (cells[j].textContent.toLowerCase().includes(searchInput)) {
                        showRow = true;
                        break;
                    }
                }
                rows[i].style.display = showRow ? '' : 'none';
            }
        }
    </script>
</body>
</html>
